Provenance
==========
The provenance layer in Hopsworks allows for the tracking of file(HopsFS) and application(YARN) operations in order to provide users with additional details.
There are currently four types of provenance:

* DISABLED
* META - enables search of projects and datasets.
* MIN - enables search of featuregroups, training datasets and features including attached tags.
* FULL - allows linking of feature groups, training datasets, experiments and models.

**Note:** Linking of ML artifacts (FULL provenance) is a Hopsworks Enterprise feature.

Temporary limitations:

* Provenance can only be set cluster wide, by an administrator, under Hopsworks :ref:`Variables<prov_cluster_var>`.  The variable of interest is **provenance_type** and it can take the values *DISABLED / META / MIN / FULL*.
* Changing provenance type only affects newly created projects. 
* There is currently no way to change/clean provenance for old projects. The only workaround for the moment is to delete and recreate the project under a different cluster provenance setup.

.. _prov_cluster_var: 
.. figure:: ../imgs/hopsml/provenance/prov_var.png
   :alt: Provenance Cluster Variable
   :target: `prov_cluster_var`_
   :align: center
   :figclass: align-center
   :scale: 30 %

   Provenance Cluster Variable

Provenance Links
----------------
For Feature Groups we can expand :ref:`Provenance <prov_links_fgs>` with further more :ref:`Details <prov_links_fgs_details>` including:

* Training Datasets generated from this Feature Group

.. _prov_links_fgs: 
.. figure:: ../imgs/hopsml/provenance/prov_links_fgs.png
   :alt: Feature Group Links
   :target: `prov_links_fgs`_
   :align: center
   :figclass: align-center

   Feature Group Provenance Links

.. _prov_links_fgs_details:
.. figure:: ../imgs/hopsml/provenance/prov_links_fgs_details.png
   :alt: Feature Group Links - Details
   :target: `prov_links_fgs_details`_
   :align: center
   :figclass: align-center
   :scale: 30 %
   
   Feature Group Provenance Links - Details

For Training Datasets we can expand :ref:`Provenance <prov_links_tds>` with further more :ref:`Details <prov_links_tds_details>` including:

* Feature Groups used to create this Traininig Dataset
* Experiments using this Training Dataset
* Models generated by an Experiment using the current Training Dataset. 


.. _prov_links_tds:
.. figure:: ../imgs/hopsml/provenance/prov_links_tds.png
   :alt: Training Dataset Links
   :target: `prov_links_tds`_
   :align: center
   :figclass: align-center

   Training Dataset Provenance Links

.. _prov_links_tds_details:
.. figure:: ../imgs/hopsml/provenance/prov_links_tds_details.png
   :alt: Training Dataset Links - Details
   :target: `prov_links_tds_details`_
   :align: center
   :figclass: align-center
   :scale: 30 %
   
   Training Dataset Provenance Links - Details

For Experiments :ref:`Provenance <prov_links_experiments>` adds:

* Training Dataset used in this Experiment

.. _prov_links_experiments: 
.. figure:: ../imgs/hopsml/provenance/prov_links_experiments.png
   :alt: Experiment links
   :target: `prov_links_experiments`_
   :align: center
   :figclass: align-center

   Experiment Provenance Links

For Models :ref:`Provenance <prov_links_models>` adds:

* Training Dataset used to generate this Model

.. _prov_links_models:
.. figure:: ../imgs/hopsml/provenance/prov_links_models.png
   :alt: Model links
   :target: `prov_links_models`_
   :align: center
   :figclass: align-center
   
   Model Provenance Links